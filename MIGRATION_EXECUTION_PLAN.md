# 方案2完全迁移执行计划

## ⚠️ 风险确认

用户已确认：**"确认执行方案2，接受所有风险"**

## 执行策略

### 阶段1：准备工作（当前）

1. ✅ 创建备份记录
2. ✅ 记录当前代码状态
3. [-] 创建迁移检查清单

### 阶段2：从最简单的handler开始（List）

**原因**：List handler最简单（~100行），风险最低

**步骤**：
1. 分析List结构
2. 移除状态字段
3. 重写为无状态
4. 测试验证

### 阶段3：迁移View handler

**复杂度**：中等

**需要处理**：
- before函数的状态管理
- perm访问字段改为参数

### 阶段4：迁移Create handler

**复杂度**：中低

### 阶段5：迁移Manage handler

**复杂度**：高（最复杂，多个exec方法）

### 阶段6：全面测试和修复

## 当前状态记录

### 原始文件

```
src/handler/problem.rs - 550行
- View: 23-109行
- Create: 110-149行
- Manage: 152-319行
- List: 321-419行
- 路由函数: 421-549行
```

## 执行日志

- 2026-01-07 11:37 - 用户确认执行方案2
- 2026-01-07 11:38 - 开始迁移准备

## 下一步

开始迁移List handler（最简单）